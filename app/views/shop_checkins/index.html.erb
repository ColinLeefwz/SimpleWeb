
<div class="subtitle">签到列表</div>
<table width="100%" border="0" cellpadding="0" cellspacing="0" class="tab">
  <tr>
    <th width="15%" class="first">用户</th>
    <th width="7%">性别</th>
    <th width="16%" align="center">生日</th>
    <th width=25%" align="center">签到时间</th>
    <th width="9%" align="center"></th>
    <th width="9%" align="center"></th>
    <th width="9%" align="center"></th>
  </tr>


  <% @checkins.each do |checkin| %>
    <tr>
      <td class="gray"><%=link_to checkin.user.name %></td>
      <td align="center" class="gray"><%= checkin.user.show_gender%></td>
      <td align="center" class="gray"><%= checkin.user.birthday.try(:to_date)%></td>
      <td align="center" class="gray"><%= checkin.cat.strftime("%Y-%m-%d %H:%M:%S") %></td>
      <td><%=  checkin.user.is_staff? ? "已是员工" : link_to('加为员工', '#', :onclick => "ajaxAddStaff($(this), '#{checkin.user.id}');")%></td>
      <td><%= link_to '历史签到', url_for(:action => 'index', :uid => checkin.user.id) %></td>
      <td><%= link_to '链接到微博', checkin.user.weibo_home %></td>

    </tr>
  <% end %>
  <tr class="bottom">
    <td align="left"></td>
    <td colspan="3" align="right">
      <%= generate_paginate.html_safe %>
    </td>
  </tr>
</table>

<script type="text/javascript">
  function ajaxAddStaff(obj, uid){
    if(confirm("确定要加为员工？"))
      $.post("/shop_staffs/ajax_add_staff",{id: uid}, function(data) {
        obj.replaceWith(data['text'])
      });
  }

</script>

