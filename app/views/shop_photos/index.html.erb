<div class="title2"><h2>照片墙</h2></div>

<table width="100%" border="0" cellpadding="0" cellspacing="0" class="tab">
  <tr>
    <th width="20%" align="center">缩略图</th>
    <th width="20%" align="center">用户</th>
    <th width="28%" align="left">描述</th>
    <th width="12%" align="left">分享到微博</th>
    <th width="12%" align="left">分享到qq</th>
    <th width="8%" align="left">操作</th>
  </tr>
  <% @photos.each do |photo| %>
    <tr>
      <td align="center"><%=image_tag photo.img.try(:url, :t2), :class=>"imgs4"  %></td>
      <td align="center"> <%= photo.user.try(:name)   %></td>
      <td title="<%= photo.desc %>"><%=truncate photo.desc, :length => 10 %></td>
      <td><%= photo.weibo ? '是' : '否' %></td>
      <td><%= photo.qq ? '是' : '否' %></td>
      <td><%= link_to '删除', "#",:onclick => "ajaxDel($(this), '#{photo.id}')"  %></td>
    </tr>
  <% end %>
</table>
<div class="pages mt15">
  <%= generate_paginate.html_safe %>
</div>

<script type ="text/javascript">
  LeftMenu(15);
  function ajaxDel(obj, id){
    if(confirm("确定删除此照片"))
    {
      $.get("/shop_photos/ajax_del",{id: id}, function(data) {
        if(data['text']){
          obj.parent().parent().remove();
        }
        else{
          obj.replaceWith('删除失败.')
        }
      });
    }
  }
</script>